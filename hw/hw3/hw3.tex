\RequirePackage[orthodox]{nag}
\documentclass[11pt]{article}

%% Define the include path
\makeatletter
\providecommand*{\input@path}{}
\g@addto@macro\input@path{{include/}{../include/}}
\makeatother

\usepackage{../../include/akazachk}


\title{ECH4905 ChemE Optimization HW 3}
\author{Andres Espinosa}

\begin{document}
\maketitle

\section{Problem 1}
Take the feasible set defined by the constraints
\[
\begin{aligned}
x_1 + x_2 &\leq 3 \\
x_1 + x_3 &\leq 7 \\
x_1 &\geq 0 \\
x_2 &\geq 0 \\
x_3 &\geq 0
\end{aligned}
\]

\subsection{Part a}
Express the constraints in standard form
\\
\textbf{Solution: }
To move this feasible set to standard form, we add slack variables to turn the inequalities into 
\[
\begin{aligned}
x_1 + x_2 + s_1 & = 3 \\
x_1 + x_3 + s_2 & = 7 \\
x_1, x_2, x_3, s_1, s_2 & \geq 0
\end{aligned}
\]
which can be expressed in matrix form as 
\[
\begin{aligned}
A \textbf{x}& = b \\
\textbf{x} &\succeq 0
\end{aligned}
\]
where
\begin{align*}
    A =
  \begin{bmatrix}
     1 & 1 & 0 & 1 & 0 \\
     1 & 0 & 1 & 0 & 1
  \end{bmatrix}
  \quad
  b = 
  \begin{bmatrix}
    3 \\ 7
  \end{bmatrix}
  \quad
  \textbf{x} = 
  \begin{bmatrix}
    x_1 \\ x_2 \\ x_3 \\ s_1 \\ s_2
  \end{bmatrix}
\end{align*}

\subsection{Part b}
Identify the basic solutions, and among them, those that are feasible
\\
\textbf{Solution: }
To identify the basic solutions, we can group the columns into the following sets of two, select those columns as the basis of a matrix $B$, and solve for \textbf{x}:
\begin{enumerate}
    \item $J_{1} = 1,2$
    \begin{align*}
      B = 
      \begin{bmatrix}
        1 & 1 \\ 1 & 0
      \end{bmatrix}
      \quad
      B^{-1} =
      \begin{bmatrix}
        0 & 1 \\ 1 & -1
      \end{bmatrix}
      \quad 
      \textbf{x}_{B} = B^{-1} b = 
      \begin{bmatrix}
        7 \\ -4
      \end{bmatrix}
      \quad
      \textbf{x} =
      \begin{bmatrix}
        7 \\ -4 \\ 0 \\ 0 \\ 0
      \end{bmatrix}
    \end{align*}
    \item $J_{2} = 1,3$
    \begin{align*}
        B = 
        \begin{bmatrix}
          1 & 0 \\ 1 & 1
        \end{bmatrix}
        \quad
        B^{-1} =
        \begin{bmatrix}
          1 & 0 \\ -1 & 1
        \end{bmatrix}
        \quad 
        \textbf{x}_{B} = B^{-1} b = 
        \begin{bmatrix}
          3 \\ 10
        \end{bmatrix}
        \quad
        \textbf{x} =
        \begin{bmatrix}
          3 \\ 0 \\ 10 \\ 0 \\ 0
        \end{bmatrix}
      \end{align*}
    \item $J_{3} = 1,4$
    \begin{align*}
        B = 
        \begin{bmatrix}
          1 & 1 \\ 1 & 0
        \end{bmatrix}
        \quad
        B^{-1} =
        \begin{bmatrix}
          0 & 1 \\ 1 & -1
        \end{bmatrix}
        \quad 
        \textbf{x}_{B} = B^{-1} b = 
        \begin{bmatrix}
          7 \\ -4
        \end{bmatrix}
        \quad
        \textbf{x} =
        \begin{bmatrix}
          7 \\ 0 \\ 0 \\ -4 \\ 0
        \end{bmatrix}
      \end{align*}
    \item $J_{4} = 1,5$
    \begin{align*}
        B = 
        \begin{bmatrix}
          1 & 0 \\ 1 & 1
        \end{bmatrix}
        \quad
        B^{-1} =
        \begin{bmatrix}
          1 & 0 \\ -1 & 1
        \end{bmatrix}
        \quad 
        \textbf{x}_{B} = B^{-1} b = 
        \begin{bmatrix}
          3 \\ 10
        \end{bmatrix}
        \quad
        \textbf{x} =
        \begin{bmatrix}
          3 \\ 0 \\ 0 \\ 0 \\ 10
        \end{bmatrix}
      \end{align*}
    \item $J_{5} = 2,3$
    \begin{align*}
        B = 
        \begin{bmatrix}
          1 & 0 \\ 0 & 1
        \end{bmatrix}
        \quad
        B^{-1} =
        \begin{bmatrix}
          1 & 0 \\ 0 & 1
        \end{bmatrix}
        \quad 
        \textbf{x}_{B} = B^{-1} b = 
        \begin{bmatrix}
          3 \\ 7
        \end{bmatrix}
        \quad
        \textbf{x} =
        \begin{bmatrix}
          0 \\ 3 \\ 7 \\ 0 \\ 0
        \end{bmatrix}
      \end{align*}
    \item $J_{6} = 2,4$
    These columns are linearly dependent and therefore do not form a basis and are not a basic solution.
    \item $J_{7} = 2,5$
    \begin{align*}
        B = 
        \begin{bmatrix}
          1 & 0 \\ 0 & 1
        \end{bmatrix}
        \quad
        B^{-1} =
        \begin{bmatrix}
          1 & 0 \\ 0 & 1
        \end{bmatrix}
        \quad 
        \textbf{x}_{B} = B^{-1} b = 
        \begin{bmatrix}
          3 \\ 7
        \end{bmatrix}
        \quad
        \textbf{x} =
        \begin{bmatrix}
          0 \\ 3 \\ 0 \\ 0 \\ 7
        \end{bmatrix}
      \end{align*}
    \item $J_{8} = 3,4$
    \begin{align*}
        B = 
        \begin{bmatrix}
          0 & 1 \\ 1 & 0
        \end{bmatrix}
        \quad
        B^{-1} =
        \begin{bmatrix}
          0 & 1 \\ 1 & 0
        \end{bmatrix}
        \quad 
        \textbf{x}_{B} = B^{-1} b = 
        \begin{bmatrix}
          7 \\ 3
        \end{bmatrix}
        \quad
        \textbf{x} =
        \begin{bmatrix}
          0 \\ 0 \\ 7 \\ 3 \\ 0
        \end{bmatrix}
      \end{align*}
    \item $J_{9} = 3,5$
    This is not a basic solution since the columns are linearly dependent
    \item $J_{10} = 4,5$
    \begin{align*}
        B = 
        \begin{bmatrix}
          1 & 0 \\ 0 & 1
        \end{bmatrix}
        \quad
        B^{-1} =
        \begin{bmatrix}
          1 & 0 \\ 0 & 1
        \end{bmatrix}
        \quad 
        \textbf{x}_{B} = B^{-1} b = 
        \begin{bmatrix}
          3 \\ 7
        \end{bmatrix}
        \quad
        \textbf{x} =
        \begin{bmatrix}
          0 \\ 0 \\ 0 \\ 3 \\ 7
        \end{bmatrix}
      \end{align*}
\end{enumerate}
The basic solutions are $J_i, \forall i \in [1,2,3,4,5,7,8,10]$.
The basic \textit{feasible} solutions are $J_i, \forall i \in [2,4,5,7,8,10]$.


\subsection{Part c}
For each point corresponding to a feasible basic solution identify the basic directions
\\
\textbf{Solution: }
Since there are 6 basic feasible solution points, and 3 non-basic variables for each, there will be 18 total basic directions.
To be less confusing, I will index them with $d_i^j$, where $i$ is the non-basic variable index and $j$ is the index of the basic feasible solution that it corresponds to.
\begin{enumerate}
    \item $j = 2 = [1,3]$
    \begin{align*} 
        d_2^2 = \textbf{P}
      \begin{bmatrix}
         d_{B2} \\ d_{N2}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ -1 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 0
        \end{bmatrix} \\
        1 \\ 0 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 1 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ 1 \\ 1 \\ 0 \\ 0 
      \end{bmatrix}
      =
      \begin{bmatrix}
        -1 \\ 1 \\ 1 \\ 0 \\ 0 
      \end{bmatrix}
      \\
      d_4^2 = \textbf{P}
      \begin{bmatrix}
         d_{B4} \\ d_{N4}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ -1 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 0
        \end{bmatrix} \\
        0 \\ 1 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 1 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ 1 \\ 0 \\ 1 \\ 0 
      \end{bmatrix}
      =
      \begin{bmatrix}
        -1 \\ 0 \\ 1 \\ 1 \\ 0 
      \end{bmatrix}
      \\
      d_5^2 = \textbf{P}
      \begin{bmatrix}
         d_{B5} \\ d_{N5}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ -1 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            0 \\ 1
        \end{bmatrix} \\
        0 \\ 0 \\ 1
      \end{bmatrix}
      = 
      \begin{bmatrix}
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 1 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        0 \\ -1 \\ 0 \\ 0 \\ 1
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 0 \\ -1 \\ 0 \\ 1 
      \end{bmatrix}
    \end{align*}
    \item $j=4 = [1,5]$
    \begin{align*} 
        d_2^4 = \textbf{P}
      \begin{bmatrix}
         d_{B2} \\ d_{N2}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ -1 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 0
        \end{bmatrix} \\
        1 \\ 0 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ 1 \\ 1 \\ 0 \\ 0 
      \end{bmatrix}
      =
      \begin{bmatrix}
        -1 \\ 1 \\ 0 \\ 0 \\ 1 
      \end{bmatrix}
      \\
      d_3^4 = \textbf{P}
      \begin{bmatrix}
         d_{B3} \\ d_{N3}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ -1 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            0 \\ 1
        \end{bmatrix} \\
        0 \\ 1 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        0 \\ -1 \\ 0 \\ 1 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 0 \\ 1 \\ 0 \\ -1
      \end{bmatrix}
      \\
      d_4^4 = \textbf{P}
      \begin{bmatrix}
         d_{B4} \\ d_{N4}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ -1 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 0
        \end{bmatrix} \\
        0 \\ 0 \\ 1
      \end{bmatrix}
      = 
      \begin{bmatrix}
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ 1 \\ 0 \\ 0 \\ 1
      \end{bmatrix}
      =
      \begin{bmatrix}
        -1 \\ 0 \\ 0 \\ 1 \\ 1 
      \end{bmatrix}
    \end{align*}
    \item $j=5 = [2,3]$
    \begin{align*}
        d_1^5 = \textbf{P}
      \begin{bmatrix}
         d_{B1} \\ d_{N1}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 1
        \end{bmatrix} \\
        1 \\ 0 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ -1 \\ 1 \\ 0 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        1 \\ -1 \\ -1 \\ 0 \\ 0
      \end{bmatrix}
      \\
      d_4^5 = \textbf{P}
      \begin{bmatrix}
         d_{B4} \\ d_{N4}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 0
        \end{bmatrix} \\
        0 \\ 1 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ 0 \\ 0 \\ 1 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ -1 \\ 0 \\ 1 \\ 0
      \end{bmatrix}
      \\
      d_5^5 = \textbf{P}
      \begin{bmatrix}
         d_{B5} \\ d_{N5}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            0 \\ 1
        \end{bmatrix} \\
        0 \\ 0 \\ 1
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        0 \\ -1 \\ 0 \\ 0 \\ 1
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 0 \\ -1 \\ 0 \\ 1
      \end{bmatrix}
    \end{align*}
    \item $j=7 = [2,5]$
    \begin{align*}
        d_1^7 = \textbf{P}
      \begin{bmatrix}
         d_{B1} \\ d_{N1}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 1
        \end{bmatrix} \\
        1 \\ 0 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ -1 \\ 1 \\ 0 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        1 \\ -1 \\ 0 \\ 0 \\ -1
      \end{bmatrix}
      \\
      d_3^7 = \textbf{P}
      \begin{bmatrix}
         d_{B3} \\ d_{N3}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            0 \\ 1
        \end{bmatrix} \\
        0 \\ 1 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        0 \\ -1 \\ 0 \\ 1 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 0 \\ 1 \\ 0 \\ -1
      \end{bmatrix}
      \\
      d_4^7 = \textbf{P}
      \begin{bmatrix}
         d_{B4} \\ d_{N4}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 0
        \end{bmatrix} \\
        0 \\ 0 \\ 1
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ 0 \\ 0 \\ 0 \\ 1
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 0 \\ 0 \\ 1 \\ -1
      \end{bmatrix}
    \end{align*}
    \item $j=8 = [3,4]$
    \begin{align*}
        d_1^8 = \textbf{P}
      \begin{bmatrix}
         d_{B1} \\ d_{N1}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         0 & 1 \\ 1 & 0   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 1
        \end{bmatrix} \\
        1 \\ 0 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ -1 \\ 1 \\ 0 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        1 \\ 0 \\ -1 \\ -1 \\ 0
      \end{bmatrix}
      \\
      d_2^8 = \textbf{P}
      \begin{bmatrix}
         d_{B2} \\ d_{N2}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         0 & 1 \\ 1 & 0   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 0
        \end{bmatrix} \\
        0 \\ 1 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        0 \\ -1 \\ 0 \\ 1 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 1 \\ 0 \\ -1 \\ 0
      \end{bmatrix}
      \\
      d_5^8 = \textbf{P}
      \begin{bmatrix}
         d_{B5} \\ d_{N5}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         0 & 1 \\ 1 & 0   
        \end{bmatrix}
        \begin{bmatrix}
            0 \\ 1
        \end{bmatrix} \\
        0 \\ 0 \\ 1
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 1
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ 0 \\ 0 \\ 0 \\ 1
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 0 \\ -1 \\ 0 \\ 1
      \end{bmatrix}
    \end{align*}
    \item $j=10 = [4,5]$
    \begin{align*}
        d_1^{10} = \textbf{P}
      \begin{bmatrix}
         d_{B1} \\ d_{N1}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 1
        \end{bmatrix} \\
        1 \\ 0 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ -1 \\ 1 \\ 0 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        1 \\ 0 \\ 0 \\ -1 \\ -1
      \end{bmatrix}
      \\
      d_2^{10} = \textbf{P}
      \begin{bmatrix}
         d_{B2} \\ d_{N2}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            1 \\ 0
        \end{bmatrix} \\
        0 \\ 1 \\ 0
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        -1 \\ 0 \\ 0 \\ 1 \\ 0
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 1 \\ 0 \\ -1 \\ 0
      \end{bmatrix}
      \\
      d_3^{10} = \textbf{P}
      \begin{bmatrix}
         d_{B3} \\ d_{N3}
      \end{bmatrix}
      =
      \textbf{P}
      \begin{bmatrix}
        -
        \begin{bmatrix}
         1 & 0 \\ 0 & 1   
        \end{bmatrix}
        \begin{bmatrix}
            0 \\ 1
        \end{bmatrix} \\
        0 \\ 0 \\ 1
      \end{bmatrix}
      = 
      \begin{bmatrix}
        0 & 0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 & 1 \\
        1 & 0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 & 0
      \end{bmatrix}
      \begin{bmatrix}
        0 \\ -1 \\ 0 \\ 0 \\ 1
      \end{bmatrix}
      =
      \begin{bmatrix}
        0 \\ 0 \\ 1 \\ 0 \\ -1
      \end{bmatrix}
    \end{align*}
\end{enumerate}

\section{Problem 2}
Solve the following optimization problem using the two-stage simplex method
\[
\begin{aligned}
\text{min } & -9x_1 - 4x_2 \\
\text{s.t. } & 5x_1 + 2x_2 \leq 31 \\
& -3x_1 + 2x_2 \leq 5 \\
& -2x_1 - 3x_2 \leq -1 \\
& x_1 \geq 0 \\
& x_2 \geq 0
\end{aligned}
\]

\subsection{Part a}
Use the two-stage simplex tableau
\\
\textbf{Solution: }

\subsection{Part b}
Use GAMS to solve the optimization problem
\\
\textbf{Solution: }

\section{Problem 3}
An oil refinery purchases two crude oils (crude 1 and crude 2). These crude oils are put through four processes: distillation, reforming, cracking, and blending, to produce petrols and fuels that are sold.

\textbf{Distillation:} distillation separates each crude oil into fractions known as light naphtha, medium naphtha, heavy naphtha, light oil, heavy oil, and residuum according to their boiling points.

Light, medium, and heavy naphthas have octane numbers of 90, 80, and 70, respectively. The fractions into which one barrel of each type of crude splits are given in the following table:

\begin{tabular}{lcccccc}
    & Light naphtha & Medium naphtha & Heavy naphtha & Light oil & Heavy oil & Residuum \\
    \hline
    Crude 1 & 0.1 & 0.2 & 0.2 & 0.12 & 0.2 & 0.13 \\
    Crude 2 & 0.15 & 0.25 & 0.18 & 0.08 & 0.19 & 0.12 \\
\end{tabular}

Note that there is a small wastage in the distillation operation (i.e., fractions do not add to 1).

\textbf{Reforming:} the naphthas can be used immediately for blending into different grades of petrol or can go through a process known as reforming. Reforming produces a product known as reformed gasoline with an octane number of 115. The yields of reformed gasoline from each barrel of the different naphthas are given as follows:

\begin{itemize}
    \item 1 barrel of light naphtha yields 0.6 barrels of reformed gasoline
    \item 1 barrel of medium naphtha yields 0.52 barrels of reformed gasoline
    \item 1 barrel of heavy naphtha yields 0.45 barrels of reformed gasoline
\end{itemize}

\textbf{Cracking:} the oils (light and heavy) can either be used directly for blending into jet fuel or fuel oil or be put through a process known as catalytic cracking. The catalytic cracker produces cracked oil and cracked gasoline. Cracked gasoline has an octane number of 105.

\begin{itemize}
    \item 1 barrel of light oil yields 0.68 barrels of cracked oil and 0.28 barrels of cracked gasoline
    \item 1 barrel of heavy oil yields 0.75 barrels of cracked oil and 0.2 barrels of cracked gasoline
\end{itemize}

Cracked oil is used for blending fuel oil and jet fuel; cracked gasoline is used for blending petrol.

Residuum can be used for either producing lube oil or blending into jet fuel and fuel oil:
\begin{itemize}
    \item 1 barrel of residuum yields 0.5 barrels of lube oil.
\end{itemize}

\textbf{Blending:}
\begin{itemize}
    \item Petrols: there are two types of petrol, regular and premium, obtained by blending the naphtha, reformed gasoline, and cracked gasoline. The only stipulations concerning them are that regular must have an octane number of at least 84 and that premium must have an octane number of at least 94. It is assumed that octane numbers blend linearly by volume.
    \item Jet fuel: the stipulation concerning jet fuel is that its vapor pressure must not exceed 1 kg/cm\textsuperscript{2}. The vapor pressures for light, heavy, cracked oils, and residuum are 1.0, 0.6, 1.5, and 0.05 kg/cm\textsuperscript{2}. It may again be assumed that vapor pressures blend linearly by volume.
    \item Fuel oil: To produce fuel oil, we blend light oil, cracked oil, heavy oil, and residuum in a ratio of 10:4:3:1.
\end{itemize}

There are some availability and capacity limitations on the quantities and processes used as follows:
\begin{itemize}
    \item The daily availability of crude 1 is 20000 barrels
    \item The daily availability of crude 2 is 30000 barrels
    \item At most 45000 barrels of crude can be distilled per day
    \item At most 10000 barrels of naphtha can be reformed per day
    \item At most 8000 barrels of oil can be cracked per day
    \item The daily production of lube oil must be between 500 and 1000 barrels
    \item Premium motor fuel production must be at least 40\% of regular motor fuel production
\end{itemize}

The profit contributions from the sale of the final products are (in dollars per barrel) as follows:
\begin{itemize}
    \item Premium petrol: 700
    \item Regular petrol: 600
    \item Jet fuel: 400
    \item Fuel oil: 350
    \item Lube oil: 150
\end{itemize}

How should the operations of the refinery be planned in order to maximize the total profit?
\subsection{Part a}
Develop a model based on the provided information
\\
\textbf{Solution: }
\begin{center}
  \begin{tikzpicture}
    % Draw the distiller rectangle
      \draw[thick] (0,0) rectangle (1,5);
      \node at (0.5,2.5) {Dis};

      % Draw the crude oil approaching the distiller
      \draw[->, thick] (-2,1) -- (0,1);
      \node[circle, draw, thin, minimum size=2em] at (-2.5,1) {$c_1$};
      \draw[->, thick] (-2,4) -- (0,4);
      \node[circle, draw, thin, minimum size=2em] at (-2.5,4) {$c_2$};

      % Draw the arrows leaving the distiller
      \draw[->, thick] (1,5) -- (3,5);
      \node[circle, draw, thin, minimum size=2em] at (3.5,5) {$n_l$};
      \draw[->, thick] (1,4) -- (3,4);
      \node[circle, draw, thin, minimum size=2em] at (3.5,4) {$n_m$};
      \draw[->, thick] (1,3) -- (3,3);
      \node[circle, draw, thin, minimum size=2em] at (3.5,3) {$n_h$};
      \draw[->, thick] (1,2) -- (3,2);
      \node[circle, draw, thin, minimum size=2em] at (3.5,2) {$o_l$};
      \draw[->, thick] (1,1) -- (3,1);
      \node[circle, draw, thin, minimum size=2em] at (3.5,1) {$o_h$};
      \draw[->, thick] (1,0) -- (3,0);
      \node[circle, draw, thin, minimum size=2em] at (3.5,0) {$r$};

      % Draw the arrows entering the refiner
      \draw[->, thick] (4,5) -- (5,4.1);
      \draw[->, thick] (4,4) -- (5,4);
      \draw[->, thick] (4,3) -- (5,3.9);
      \node[rectangle, draw, thin, minimum size=2em] at (5.5,4) {Ref};

      \draw[->, thick] (6,4) -- (7,4);
      \node[circle, draw, thin, minimum size=2em] at (7.5,4) {$g_r$};

      % Draw the rectangle between ol and oh
      \node[rectangle, draw, thin, minimum size=2em] at (5.5,1.5) {Cra};

      % Draw the arrows pointing to the rectangle
      \draw[->, thick] (4,2) -- (5,1.6);
      \draw[->, thick] (4,1) -- (5,1.4);

      % Add titles to the diamonds
      \node[diamond, draw, thin, minimum size=1em] at (11, 5.5) {$P_p$};
      \node[diamond, draw, thin, minimum size=1em] at (11, 4) {$P_r$};
      \node[diamond, draw, thin, minimum size=1em] at (11, 2.5) {$J_f$};
      \node[diamond, draw, thin, minimum size=1em] at (11, 1) {$O_f$};
      \node[diamond, draw, thin, minimum size=1em] at (11, -0.5) {$O_l$};

      % Draw the arrows from cracked oil to fuel oil and jet fuel
      \draw[->, thick] (6,1.25) -- (7,1);
      \draw[->, thick] (6,1.75) -- (7,2);

      \node[circle, draw, thin, minimum size=2em] at (7.5,2) {$o_c$};
      \node[circle, draw, thin, minimum size=2em] at (7.5,1) {$g_c$};

      % Draw the arrows from naphtha, reformed gasoline, and cracked gasoline to petrols
      \draw[->, thick, dotted] (4,5) -- (10.25,5.75);
      \draw[->, thick, dotted] (4,4) -- (10.25,5.5);
      \draw[->, thick, dotted] (4,3) -- (10.25,5.25);
      \draw[->, thick, dotted] (4,5) -- (10.25,4.25);
      \draw[->, thick, dotted] (4,4) -- (10.25,4);
      \draw[->, thick, dotted] (4,3) -- (10.25,3.75);

      % Draw the arrows from oils and residuum to jet fuel
      \draw[->, thick, dotted] (4,2) -- (10.25,2.75);
      \draw[->, thick, dotted] (4,1) -- (10.25,2.5);
      \draw[->, thick, dotted] (7.5,2) -- (10.25,2.625);
      \draw[->, thick, dotted] (4,0) -- (10.25,2.25);

      % Draw the arrows from oils and residuum to fuel oil
      \draw[->, thick, dotted] (4,2) -- (10.25,1.25);
      \draw[->, thick, dotted] (7.5,2) -- (10.25,1.125);
      \draw[->, thick, dotted] (4,1) -- (10.25,1);
      \draw[->, thick, dotted] (4,0) -- (10.25,0.75);

      % Draw the arrow from residuum to lube oil
      \draw[->, thick, dotted] (4,0) -- (10.25,-0.5);

      % Draw the arrows from cracked gasoline and oil to jet fuel
      \draw[->, thick] (8,1) -- (10.25,2.25);
      \draw[->, thick] (8,2) -- (10.25,2.5);

      % Draw the arrows from cracked gasoline and oil to fuel oil
      \draw[->, thick] (8,1) -- (10.25,1);
      \draw[->, thick] (8,2) -- (10.25,1.25);

      % Draw the arrows from refined gasoline to premium petrol and regular petrol
      \draw[->, thick] (8,4) -- (10.25,5.5);
      \draw[->, thick] (8,4) -- (10.25,4);
  \end{tikzpicture}
\end{center}

For this problem above, we can define the following parameters and variables:
\begin{align*}
& \text{Sets: } \\
& C: \text{Set of crude oil inputs } o \in [1,2] \\
& D: \text{Set of distillations } o \in [3] \\
& R: \text{Set of refineries } o \in [4] \\
& A: \text{Set of cracking stations } o \in [5] \\
& B: \text{Set of blenders } o \in [6,7,8,9,10,11] \\
& I: \text{Set of inputs and outputs $c_1,c_2,n_l, n_m, n_h, o_l, o_h, r, g_r, o_c, g_c, P_p, P_r, J_f, O_f, O_l$ } i \in [1,\dots,16] \\
& \text{Parameters:} \\
& y_{i,j}^O: \text{Yield of output $j$ produced by input $i$ and processed by op $O$.} \\
& o_{j}: \text{Octane rating output $j$.} \\
& a_i: \text{Daily availability of input $i$} \\
& \text{Profit contributions:} \\
& c_{j}: \text{Profit per barrel of output $j$.} \\
& \text{Variables:} \\
& x_{j}^O : \text{Quantity of output $j$ produced by op $O$. (Barrels)} \\
\end{align*}
The objective function can be formulated as 
\begin{align*}
  \text{maximize} & \quad  \sum_{j}^I c_{j} \sum_{i}^I \sum_{o}^O x_{i,j}^o
\end{align*}
The input and output yield constraints can be formulated as
\begin{align*}
  \text{Availability Constraints} & \quad x_{1}^1 \leq 20000 \\ 
  & \quad x_{2}^2 \leq 30000 \\
  & \quad x_{1}^1 + x_{2}^2 \leq 45000
\end{align*}

\begin{align*}
  \text{Distilling Constraints} & \quad x_{j}^3 = y_{1,j}^3 x_{1}^1 + y_{2,j}^3 x_{2}^2, \quad \forall j \in [3,4,5,6,7,8] \\
  & \quad \sum_{j \in [3,4,5]} x_{j}^4 \leq 10000
\end{align*}

\begin{align*}
  \text{Reforming Constraints} & \quad x_{j}^4 = y_{3,j}^4 x_{3}^3 + y_{4,j}^4 x_{4}^4 +  y_{5,j}^4 x_{5}^4, \quad \forall j \in [9]
\end{align*}





\subsection{Part b}
Find the optimal value in GAMS
\\
\textbf{Solution: }


\end{document}